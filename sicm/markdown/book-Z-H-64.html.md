<div class="navigation">

[Go to <span>[first](book.html),
[previous](book-Z-H-63.html)</span><span>,
[next](book-Z-H-65.html)</span> page<span>;
  </span><span>[contents](book-Z-H-4.html#%_toc_start)</span><span><span>;
  </span>[index](book-Z-H-82.html#%_index_start)</span>]

</div>

[5.7  Time Evolution Is Canonical](book-Z-H-4.html#%_toc_%_sec_5.7)
-------------------------------------------------------------------

In this section we demonstrate that time evolution generates a canonical
transformation: if we consider all possible initial states of a
Hamiltonian system and follow all the trajectories for the same time
interval, then the map from the initial state to the final state of each
trajectory is a canonical transformation.

We use time evolution to generate a transformation

<div align="left">

![](chap5-Z-G-282.gif)

</div>

that is obtained in the following way. Let ![](chap3-Z-G-D-5.gif)(*t*) =
(*t*, ![](chap5-Z-G-D-9.gif)(*t*), ![](chap5-Z-G-D-10.gif)(*t*)) be a
solution of Hamilton's equations. The transformation
![](chap5-Z-G-D-11.gif)~![](chap1-Z-G-D-43.gif)~ satisfies

<div align="left">

![](chap5-Z-G-283.gif)

</div>

or, equivalently,

<div align="left">

![](chap5-Z-G-284.gif)

</div>

Notice that ![](chap5-Z-G-D-11.gif)~![](chap1-Z-G-D-43.gif)~ changes the
time component. This is the first transformation of this kind that we
have considered.[^24^](#footnote_Temp_390)

Given a state (*t*', *q*', *p*'), we find the phase-space path
![](chap3-Z-G-D-5.gif) emanating from this state as an initial
condition, satisfying

<div align="left">

![](chap5-Z-G-285.gif)

</div>

The value (*t*, *q*, *p*) of
![](chap5-Z-G-D-11.gif)~![](chap1-Z-G-D-43.gif)~(*t*', *q*', *p*') is
then (*t*' + ![](chap1-Z-G-D-43.gif), ![](chap5-Z-G-D-9.gif)(*t*' +
![](chap1-Z-G-D-43.gif)), ![](chap5-Z-G-D-10.gif)(*t*' +
![](chap1-Z-G-D-43.gif))).

Time evolution is canonical if the transformation
![](chap5-Z-G-D-11.gif)~![](chap1-Z-G-D-43.gif)~ is symplectic and if
the Hamiltonian transforms in an appropriate manner. The transformation
![](chap5-Z-G-D-11.gif)~![](chap1-Z-G-D-43.gif)~ is symplectic if the
bilinear antisymmetric form ![](chap1-Z-G-D-23.gif) is invariant (see
equation [5.73](book-Z-H-60.html#EQUATION_5.73)) for a general pair of
linearized state variations with zero time component.

Let ![](chap2-Z-G-D-10.gif)' be an increment with zero time component of
the state (*t*', *q*', *p*'). The linearized increment in the value of
![](chap5-Z-G-D-11.gif)~![](chap1-Z-G-D-43.gif)~(*t*', *q*', *p*') is
![](chap2-Z-G-D-10.gif) =
*D*![](chap5-Z-G-D-11.gif)~![](chap1-Z-G-D-43.gif)~(*t*', *q*', *p*')
![](chap2-Z-G-D-10.gif)'. The image of the increment is obtained by
multiplying the increment by the derivative of the transformation. On
the other hand, the transformation is obtained by time evolution, so the
image of the increment can also be found by the time evolution of the
linearized variational system. Let

<div align="left">

![](chap5-Z-G-286.gif)

</div>

be variations of the state path ![](chap3-Z-G-D-5.gif)(*t*) = (*t*,
![](chap5-Z-G-D-9.gif)(*t*), ![](chap5-Z-G-D-10.gif)(*t*)); then

<div align="left">

![](chap5-Z-G-287.gif)

</div>

The symplectic requirement is

<div align="left">

![](chap5-Z-G-288.gif)

</div>

This must be true for arbitrary ![](chap1-Z-G-D-43.gif), so it is
satisfied if the following quantity is constant:

<div align="left">

![](chap5-Z-G-289.gif)

</div>

We compute the derivative:

<div align="left">

![](chap5-Z-G-290.gif)

</div>

With Hamilton's equations, the variations satisfy

<div align="left">

![](chap5-Z-G-291.gif)

</div>

Substituting these into *DA* and collecting terms, we
find[^25^](#footnote_Temp_391)

<div align="left">

![](chap5-Z-G-292.gif)

</div>

We conclude that time evolution generates a phase-space transformation
with symplectic derivative.

To make a canonical transformation we must specify how the Hamiltonian
transforms. The same Hamiltonian describes the evolution of a state and
a time-advanced state because the latter is just another state. Thus the
transformed Hamiltonian is the same as the original Hamiltonian.

#### [Liouville's theorem, again](book-Z-H-4.html#%_toc_%_sec_Temp_392)

We deduced that volumes in phase space are preserved by time evolution
by showing that the divergence of the phase flow is zero, using the
equations of motion (see section [3.8](book-Z-H-44.html#%_sec_3.8)). We
can also show that volumes in phase space are preserved by the evolution
using the fact that time evolution is a canonical transformation.

We have shown that phase-space volume is preserved for symplectic
transformations. Now we have shown that the transformation generated by
time evolution is a symplectic transformation. Therefore, the
transformation generated by time evolution preserves phase-space volume.
This is an alternate proof of Liouville's theorem.

#### [Another time-evolution transformation](book-Z-H-4.html#%_toc_%_sec_Temp_393)

There is another canonical transformation that can be constructed from
time evolution. We define the transformation
![](chap5-Z-G-D-11.gif)'~![](chap1-Z-G-D-43.gif)~ such that

<div align="left">

![](chap5-Z-G-293.gif)

</div>

where *S*~![](chap1-Z-G-D-43.gif)~(*a*, *b*, *c*) = (*a* +
![](chap1-Z-G-D-43.gif), *b*, *c*) shifts the time of a phase-space
state.[^26^](#footnote_Temp_394) More explicitly, given a state (*t*,
*q*', *p*'), we evolve the state that is obtained by subtracting
![](chap1-Z-G-D-43.gif) from *t*; that is, we take the state (*t* `-`
![](chap1-Z-G-D-43.gif), *q*', *p*') as an initial state for evolution
by Hamilton's equations. The state path ![](chap3-Z-G-D-5.gif) satisfies

<div align="left">

![](chap5-Z-G-294.gif)

</div>

The output of the transformation is the state

<div align="left">

![](chap5-Z-G-295.gif)

</div>

The transformation satisfies

<div align="left">

![](chap5-Z-G-296.gif)

</div>

The arguments of ![](chap5-Z-G-D-11.gif)'~![](chap1-Z-G-D-43.gif)~ are
not a consistent phase-space state; the time argument must be
decremented by ![](chap1-Z-G-D-43.gif) to obtain a consistent state. The
transformation is completed by evolution of this consistent state.

Why is this a good idea? Our usual canonical transformations do not
change the time component. This modified time-evolution transformation
is thus of the form discussed previously. The resulting time-evolution
transformation is canonical and in the usual form:

<div align="left">

![](chap5-Z-G-297.gif)

</div>

This transformation can also be extended to be a canonical
transformation, with an appropriate adjustment of the Hamiltonian. The
Hamiltonian *H*'~![](chap1-Z-G-D-43.gif)~ that gives the correct
Hamilton's equations at the transformed phase-space point is the
original Hamiltonian composed with a function that decrements the
independent variable by ![](chap1-Z-G-D-43.gif):

<div align="left">

![](chap5-Z-G-298.gif)

</div>

or

<div align="left">

![](chap5-Z-G-299.gif)

</div>

Notice that if *H* is time independent then
*H*'~![](chap1-Z-G-D-43.gif)~ = *H*.

Assume we have a procedure `C` such that `((C delta-t) state)`
implements a time-evolution transformation
![](chap5-Z-G-D-11.gif)~![](chap1-Z-G-D-43.gif)~ of the state `state`
with time interval `delta-t`; then the procedure `Cp` such that
`((Cp delta-t) state)` implements
![](chap5-Z-G-D-11.gif)'~![](chap1-Z-G-D-43.gif)~ of the same state and
time interval can be derived from the procedure `C` by using the
procedure

`(define ((C->Cp C) delta-t)   (compose (C delta-t) (shift-t (- delta-t)))) `

where `shift-t` implements *S*~![](chap1-Z-G-D-43.gif)~:

`(define ((shift-t delta-t) state)   (up     (+ (time state) delta-t)    (coordinate state)    (momentum state))) `

To complete the canonical transformation we have a procedure that
transforms the Hamiltonian:

`(define ((H->Hp delta-t) H)   (compose H (shift-t (- delta-t)))) `

So both ![](chap5-Z-G-D-11.gif) and ![](chap5-Z-G-D-11.gif)' can be used
to make canonical transformations by specifying how the old and new
Hamiltonians are related. For
![](chap5-Z-G-D-11.gif)~![](chap1-Z-G-D-43.gif)~ the Hamiltonian is
unchanged. For ![](chap5-Z-G-D-11.gif)'~![](chap1-Z-G-D-43.gif)~ the
Hamiltonian is time shifted.

**Exercise 5.21.**  **Verification**\
 The condition ([5.19](book-Z-H-59.html#EQUATION_5.19)) that Hamilton's
equations are preserved for
![](chap5-Z-G-D-11.gif)~![](chap1-Z-G-D-43.gif)~ is

<div align="left">

![](chap5-Z-G-300.gif)

</div>

and the condition that Hamilton's equations are preserved for
![](chap5-Z-G-D-11.gif)'~![](chap1-Z-G-D-43.gif)~ is

<div align="left">

![](chap5-Z-G-301.gif)

</div>

Verify that these conditions are satisfied.

**Exercise 5.22.**  **Driven harmonic oscillator**\
 We can use the simple driven harmonic oscillator to illustrate that
time evolution yields a symplectic transformation that can be extended
to be canonical in two ways. We use the driven harmonic oscillator
because its solution can be compactly expressed in explicit form.

Suppose that we have a harmonic oscillator with natural frequency
![](chap1-Z-G-D-23.gif)~0~ driven by a periodic sinusoidal drive of
frequency ![](chap1-Z-G-D-23.gif) and amplitude ![](chap1-Z-G-D-21.gif).
The Hamiltonian we will consider is

<div align="left">

![](chap5-Z-G-302.gif)

</div>

The general solution for a given initial state (*t*~0~, *q*~0~, *p*~0~)
evolved for a time ![](chap1-Z-G-D-43.gif) is

<div align="left">

![](chap5-Z-G-303.gif)

</div>

where ![](chap1-Z-G-D-21.gif)' =
![](chap1-Z-G-D-21.gif)/(![](chap1-Z-G-D-23.gif)~0~^2^ `-`
![](chap1-Z-G-D-23.gif)^2^).

**a**.  Fill in the details of the procedure

`(define (((C alpha omega omega0) delta-t) state)    ... ) `

that implements the time-evolution transformation of the driven harmonic
oscillator.

**b**.  In terms of `C`, the general solution emanating from a given
state is

`(define (((solution alpha omega omega0) state0) t)   (((C alpha omega omega0) (- t (time state0))) state0)) `

Check that the implementation of `C` is correct by using it to construct
the solution and verifying that the solution satisfies Hamilton's
equations. Further check the solution by comparing to numerical
integration.

**c**.  We know that for any phase-space state function *F* the rate of
change of that function along a solution path ![](chap3-Z-G-D-5.gif) is

<div align="left">

![](chap5-Z-G-304.gif)

</div>

Show, by writing a short program to test it, that this is true of the
function implemented by `(C delta)` for the driven oscillator. Why is
this interesting?

**d**.  Verify that both `C` and `Cp` are symplectic using
`symplectic?`.

**e**.  Use the procedure `canonical?` to verify that both `C` and `Cp`
are canonical with the appropriate transformed Hamiltonian.

### [5.7.1  Another View of Time Evolution](book-Z-H-4.html#%_toc_%_sec_5.7.1)

We can also show that time evolution generates canonical transformations
using the Poincaré-Cartan integral invariant.

Consider a two-dimensional region of phase-space coordinates, *R*', at
some particular time *t*' (see figure [5.8](#FIGURE_5.8)). Let *R* be
the image of this region at time *t* under time evolution for a time
interval of ![](chap1-Z-G-D-43.gif). The time evolution is governed by a
Hamiltonian *H*. Let sum~*i*~ *A*~*i*~ be the sum of the oriented areas
of the projections of *R* onto the fundamental canonical
planes.[^27^](#footnote_Temp_397) Similarly, let sum~*i*~ *A*'~*i*~ be
the sum of oriented projected areas for *R*'. We will show that sum~*i*~
*A*~*i*~ = sum~*i*~ *A*'~*i*~, and thus the Poincaré integral invariant
is preserved by time evolution. By showing that the Poincaré integral
invariant is preserved, we will have shown that the *qp* part of the
transformation generated by time evolution is symplectic. From this we
can construct canonical transformations from time evolution as before.

In the extended phase space we see that the evolution sweeps out a
cylindrical volume with endcaps *R*' and *R*, each at a fixed time. Let
*R*'' be the two-dimensional region swept out by the trajectories that
map the boundary of region *R*' to the boundary of region *R*. The
regions *R*, *R*', and *R*'' together form the boundary of a volume of
phase-state space.

The Poincaré-Cartan integral invariant on the whole boundary is
zero.[^28^](#footnote_Temp_398) Thus

<div align="left">

![](chap5-Z-G-305.gif)

</div>

where the *n* index indicates the *t*, *p*~*t*~ canonical plane. The
second term is negative, because in the extended phase space we take the
area to be positive if the normal to the surface is outward pointing.

<div align="left">

![](chap5-Z-G-306.gif)

</div>

We will show that the Poincaré-Cartan integral invariant for a region of
phase space that is generated by time evolution is zero:

<div align="left">

![](chap5-Z-G-307.gif)

</div>

This will allow us to conclude

<div align="left">

![](chap5-Z-G-308.gif)

</div>

The areas of the projection of *R* and *R*' on the *t*, *p*~*t*~ plane
are zero because *R* and *R*' are at constant times, so for these
regions the Poincaré-Cartan integral invariant is the same as the
Poincaré integral invariant. Thus

<div align="left">

![](chap5-Z-G-309.gif)

</div>

We are left with showing that the Poincaré-Cartan integral invariant for
the region *R*'' is zero. This will be zero if the contribution from any
small piece of *R*'' is zero. We will show this by showing that the
![](chap1-Z-G-D-23.gif) form (see
equation [5.71](book-Z-H-60.html#EQUATION_5.71)) on a small
parallelogram in this region is zero. Let (0; *q*, *t*; *p*, *p*~*t*~)
be a vertex of this parallelogram. The parallelogram is specified by two
edges ![](chap2-Z-G-D-10.gif)~1~ and ![](chap2-Z-G-D-10.gif)~2~
emanating from this vertex with components (0; ![](chap1-Z-G-D-43.gif)
*q*, ![](chap1-Z-G-D-43.gif) *t*; ![](chap1-Z-G-D-43.gif) *p*,
![](chap1-Z-G-D-43.gif) *p*~*t*~). For edge ![](chap2-Z-G-D-10.gif)~1~
of the parallelogram, we take a constant-time phase-space increment with
length ![](chap1-Z-G-D-43.gif) *q* and ![](chap1-Z-G-D-43.gif) *p* in
the *q* and *p* directions. The first-order change in the Hamiltonian
that corresponds to these changes is

<div align="left">

![](chap5-Z-G-310.gif)

</div>

for constant time ![](chap1-Z-G-D-43.gif) *t* = 0. The increment
![](chap1-Z-G-D-43.gif) *p*~*t*~ is the negative of
![](chap1-Z-G-D-43.gif) *H*. So the extended phase-space increment is

<div align="left">

![](chap5-Z-G-311.gif)

</div>

The edge ![](chap2-Z-G-D-10.gif)~2~ is obtained by time evolution of the
vertex for a time interval ![](chap1-Z-G-D-43.gif) *t*. Using Hamilton's
equations, we obtain

<div align="left">

![](chap5-Z-G-312.gif)

</div>

The ![](chap1-Z-G-D-23.gif) form applied to these incremental states
that form the edges of this parallelogram gives the area of the
parallelogram:

<div align="left">

![](chap5-Z-G-313.gif)

</div>

So we may conclude that the integral of this expression over the entire
surface of the tube of trajectories is also zero. Thus the
Poincaré-Cartan integral invariant is zero for any region that is
generated by time evolution.

Having proven that the trajectory tube provides no contribution, we have
shown that the Poincaré integral invariant of the two endcaps is the
same. This proves that time evolution generates a symplectic *qp*
transformation.

#### [Area preservation of surfaces of section](book-Z-H-4.html#%_toc_%_sec_Temp_399)

We can use the Poincaré-Cartan invariant to prove that for autonomous
two-degree-of-freedom systems surfaces of section (constructed
appropriately) preserve area.

To show this we consider a surface of section for one coordinate (say
*q*~2~) equal to zero. We construct the section by accumulating the
(*q*~1~, *p*~1~) pairs. We assume that all initial conditions have the
same energy. We compute the sum of the areas of canonical projections in
the extended phase space again. Because all initial conditions have the
same *q*~2~ = 0 there is no area on the *q*~2~, *p*~2~ plane, and
because all the trajectories have the same value of the Hamiltonian the
area of the projection on the *t*, *p*~*t*~ plane is also zero. So the
sum of areas of the projections is just the area of the region on the
surface of section. Now let each point on the surface of section evolve
to the next section crossing. For each point on the section this may
take a different amount of time. Compute the sum of the areas again for
the mapped region. Again, all points of the mapped region have the same
*q*~2~ so the area on the *q*~2~, *p*~2~ plane is zero, and they
continue to have the same energy so the area on the *t*, *p*~*t*~ plane
is zero. So the area of the mapped region is again just the area on the
surface of section, the *q*~1~, *p*~1~ plane. Time evolution preserves
the sum of areas, so the area on the surface of section is the same as
the mapped area.

So surfaces of section preserve area provided that the section points
are entirely on a canonical plane. For example, to make the Hénon-Heiles
surfaces of section (see section [3.6.3](book-Z-H-42.html#%_sec_3.6.3))
we plotted *p*~*y*~ versus *y* when *x* = 0 with *p*~*x*~ \> 0. So for
all section points the *x* coordinate has the fixed value 0, the
trajectories all have the same energy, and the points accumulated are
entirely in the *y*, *p*~*y*~ canonical plane. So the Hénon-Heiles
surfaces of section preserve area.

### [5.7.2  Yet Another View of Time Evolution](book-Z-H-4.html#%_toc_%_sec_5.7.2)

We can show that time evolution generates a symplectic transformation
directly from the action principle.

Recall that the Lagrangian action *S* is

<div align="left">

![](chap5-Z-G-314.gif)

</div>

We computed the variation of the action in deriving the Lagrange
equations. The variation is (see
equation [1.33](book-Z-H-12.html#EQUATION_1.33))

<div align="left">

![](chap5-Z-G-315.gif)

</div>

rewritten in terms of the Euler-Lagrange operator *E*. In the derivation
of the Lagrange equations we considered only variations that preserved
the endpoints of the path being tested. However,
equation ([5.347](#EQUATION_5.347)) is true of arbitrary variations.
Here we consider variations that are not zero at the endpoints around a
realizable path *q* (one for which *E* [ *L* ] o
![](chap1-Z-G-D-9.gif)[*q*] = 0 ). For these variations the variation of
the action is just the integrated term:

<div align="left">

![](chap5-Z-G-316.gif)

</div>

Recall that *p* and ![](chap1-Z-G-D-13.gif) are structures, and the
product implies a sum of products of components.

Consider a continuous family of realizable paths; the path for parameter
*s* is ![](chap5-Z-G-D-12.gif)(*s*) and the coordinates of this path at
time *t* are ![](chap5-Z-G-D-12.gif)(*s*)(*t*). We define
![](chap5-Z-G-D-13.gif)(*s*) = *D*![](chap5-Z-G-D-12.gif)(*s*); the
variation of the path along the family is the derivative of the
parametric path with respect to the parameter. Let

<div align="left">

![](chap5-Z-G-317.gif)

</div>

be the value of the action from *t*~1~ to *t*~2~ for path
![](chap5-Z-G-D-12.gif)(*s*). The derivative of the action along this
parametric family of paths is[^29^](#footnote_Temp_400)

<div align="left">

![](chap5-Z-G-318.gif)

</div>

Because ![](chap5-Z-G-D-12.gif)(*s*) is a realizable path, *E*[*L*] o
![](chap1-Z-G-D-9.gif)[![](chap5-Z-G-D-12.gif)(*s*)] = 0. So

<div align="left">

![](chap5-Z-G-319.gif)

</div>

where ![](chap3-Z-G-D-3.gif)(*s*) is the conjugate momentum to
![](chap5-Z-G-D-12.gif)(*s*). The integral of *D*![](chap5-Z-G-D-14.gif)
is

<div align="left">

![](chap5-Z-G-320.gif)

</div>

where

<div align="left">

![](chap5-Z-G-321.gif)

</div>

In conventional notation the latter line integral is written

<div align="left">

![](chap5-Z-G-322.gif)

</div>

where ![](chap1-Z-G-D-1.gif)~1~(*s*) =
![](chap5-Z-G-D-12.gif)(*s*)(*t*~1~) and ![](chap1-Z-G-D-1.gif)~2~(*s*)
= ![](chap5-Z-G-D-12.gif)(*s*)(*t*~2~).

For a loop family of paths (such that ![](chap5-Z-G-D-12.gif)(*s*~2~) =
![](chap5-Z-G-D-12.gif)(*s*~1~)), the difference of actions at the
endpoints vanishes, so we deduce

<div align="left">

![](chap5-Z-G-323.gif)

</div>

which is the line-integral version of the integral invariants.

In terms of area integrals, using Stokes's theorem, this is

<div align="left">

![](chap5-Z-G-324.gif)

</div>

where *R*^*i*^~*j*~ are the regions in the *i*th canonical plane. We
have found that the time evolution preserves the integral invariants,
and thus time evolution generates a symplectic transformation.

<div class="smallprint">

------------------------------------------------------------------------

</div>

<div class="footnote">

[^24^](#call_footnote_Temp_390) Our theorems about which transformations
are canonical are still valid, because they required only that the
derivative of the independent variable be 1.

[^25^](#call_footnote_Temp_391) Partial derivatives of structured
arguments do not generally commute, so this deduction is not as simple
as it may appear. It is helpful to introduce component indices and
consider the equation componentwise.

[^26^](#call_footnote_Temp_394) The transformation
*S*~![](chap1-Z-G-D-43.gif)~ is an identity on the *qp* components, so
it is symplectic. Although it adjusts the time, it is not a
time-dependent transformation in that the *qp* components do not depend
upon the time. Thus, if we adjust the Hamiltonian by composition with
*S*~![](chap1-Z-G-D-43.gif)~ we have a canonical transformation.

[^27^](#call_footnote_Temp_397) By Stokes's theorem we may compute the
area of a region by a line integral around the boundary of the region.
We define the positive sense of the area to be the area enclosed by a
curve that is traversed in a counterclockwise direction, when drawn on a
plane with the coordinate on the abscissa and the momentum on the
ordinate.

[^28^](#call_footnote_Temp_398) We can see this as follows. Let
![](chap1-Z-G-D-1.gif) be any closed curve in the boundary. This curve
divides the boundary into two regions. By Stokes's theorem the integral
invariant over both of these pieces can be written as a line integral
along this boundary, but they have opposite signs, because
![](chap1-Z-G-D-1.gif) is traversed in opposite directions to keep the
surface on the left. So we conclude that the integral invariant over the
entire surface is zero.

[^29^](#call_footnote_Temp_400) Let *f* be a path-dependent function,
![](chap5-Z-G-D-13.gif)(*s*) = *D*![](chap5-Z-G-D-12.gif)(*s*), and
*g*(*s*) = *f*[![](chap5-Z-G-D-12.gif)(*s*)]. The variation of *f* at
![](chap5-Z-G-D-12.gif)(*s*) in the direction
![](chap5-Z-G-D-13.gif)(*s*) is
![](chap1-Z-G-D-17.gif)~![](chap5-Z-G-D-13.gif)(*s*)~
*f*[![](chap5-Z-G-D-12.gif)(*s*)] = *D* *g*(*s*).

</div>

<div class="navigation">

[Go to <span>[first](book.html),
[previous](book-Z-H-63.html)</span><span>,
[next](book-Z-H-65.html)</span> page<span>;
  </span><span>[contents](book-Z-H-4.html#%_toc_start)</span><span><span>;
  </span>[index](book-Z-H-82.html#%_index_start)</span>]

</div>

activate javascript

